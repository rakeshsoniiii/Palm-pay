<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Expense Tracker</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Rajdhani:wght@300;400;500;600;700&display=swap');
        
        :root {
            --neon-blue: #00f3ff;
            --neon-pink: #ff00ff;
            --neon-green: #39ff14;
            --neon-yellow: #ffff00;
            --neon-purple: #bd00ff;
            --neon-orange: #ff5e00;
            --neon-red: #ff073a;
            --neon-cyan: #00ffcc;
            --dark-bg: #0a0a1a;
        }
        
        body {
            font-family: 'Rajdhani', sans-serif;
            background-color: var(--dark-bg);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 0, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 70%, rgba(0, 243, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 50% 50%, rgba(57, 255, 20, 0.05) 0%, transparent 30%);
            color: #fff;
            min-height: 100vh;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
        }
        
        .neon-border-blue {
            border: 2px solid var(--neon-blue);
            box-shadow: 0 0 10px var(--neon-blue), inset 0 0 5px var(--neon-blue);
        }
        
        .neon-border-pink {
            border: 2px solid var(--neon-pink);
            box-shadow: 0 0 10px var(--neon-pink), inset 0 0 5px var(--neon-pink);
        }
        
        .neon-border-green {
            border: 2px solid var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green), inset 0 0 5px var(--neon-green);
        }
        
        .neon-border-yellow {
            border: 2px solid var(--neon-yellow);
            box-shadow: 0 0 10px var(--neon-yellow), inset 0 0 5px var(--neon-yellow);
        }
        
        .neon-border-purple {
            border: 2px solid var(--neon-purple);
            box-shadow: 0 0 10px var(--neon-purple), inset 0 0 5px var(--neon-purple);
        }
        
        .neon-border-orange {
            border: 2px solid var(--neon-orange);
            box-shadow: 0 0 10px var(--neon-orange), inset 0 0 5px var(--neon-orange);
        }
        
        .neon-border-red {
            border: 2px solid var(--neon-red);
            box-shadow: 0 0 10px var(--neon-red), inset 0 0 5px var(--neon-red);
        }
        
        .neon-border-cyan {
            border: 2px solid var(--neon-cyan);
            box-shadow: 0 0 10px var(--neon-cyan), inset 0 0 5px var(--neon-cyan);
        }
        
        .neon-text-blue {
            color: var(--neon-blue);
            text-shadow: 0 0 5px var(--neon-blue);
        }
        
        .neon-text-pink {
            color: var(--neon-pink);
            text-shadow: 0 0 5px var(--neon-pink);
        }
        
        .neon-text-green {
            color: var(--neon-green);
            text-shadow: 0 0 5px var(--neon-green);
        }
        
        .neon-text-yellow {
            color: var(--neon-yellow);
            text-shadow: 0 0 5px var(--neon-yellow);
        }
        
        .neon-text-purple {
            color: var(--neon-purple);
            text-shadow: 0 0 5px var(--neon-purple);
        }
        
        .neon-text-orange {
            color: var(--neon-orange);
            text-shadow: 0 0 5px var(--neon-orange);
        }
        
        .neon-text-red {
            color: var(--neon-red);
            text-shadow: 0 0 5px var(--neon-red);
        }
        
        .neon-text-cyan {
            color: var(--neon-cyan);
            text-shadow: 0 0 5px var(--neon-cyan);
        }
        
        .neon-bg-blue {
            background-color: rgba(0, 243, 255, 0.15);
        }
        
        .neon-bg-pink {
            background-color: rgba(255, 0, 255, 0.15);
        }
        
        .neon-bg-green {
            background-color: rgba(57, 255, 20, 0.15);
        }
        
        .neon-bg-yellow {
            background-color: rgba(255, 255, 0, 0.15);
        }
        
        .neon-bg-purple {
            background-color: rgba(189, 0, 255, 0.15);
        }
        
        .neon-bg-orange {
            background-color: rgba(255, 94, 0, 0.15);
        }
        
        .neon-bg-red {
            background-color: rgba(255, 7, 58, 0.15);
        }
        
        .neon-bg-cyan {
            background-color: rgba(0, 255, 204, 0.15);
        }
        
        .neon-glow-blue {
            box-shadow: 0 0 5px var(--neon-blue);
        }
        
        .neon-glow-pink {
            box-shadow: 0 0 5px var(--neon-pink);
        }
        
        .neon-glow-green {
            box-shadow: 0 0 5px var(--neon-green);
        }
        
        .neon-glow-yellow {
            box-shadow: 0 0 5px var(--neon-yellow);
        }
        
        .neon-glow-purple {
            box-shadow: 0 0 5px var(--neon-purple);
        }
        
        .neon-glow-orange {
            box-shadow: 0 0 5px var(--neon-orange);
        }
        
        .neon-glow-red {
            box-shadow: 0 0 5px var(--neon-red);
        }
        
        .neon-glow-cyan {
            box-shadow: 0 0 5px var(--neon-cyan);
        }
        
        .neon-glow-blue:hover {
            box-shadow: 0 0 15px var(--neon-blue), 0 0 25px var(--neon-blue);
            transition: all 0.3s ease;
        }
        
        .neon-glow-pink:hover {
            box-shadow: 0 0 15px var(--neon-pink), 0 0 25px var(--neon-pink);
            transition: all 0.3s ease;
        }
        
        .neon-glow-green:hover {
            box-shadow: 0 0 15px var(--neon-green), 0 0 25px var(--neon-green);
            transition: all 0.3s ease;
        }
        
        .neon-glow-yellow:hover {
            box-shadow: 0 0 15px var(--neon-yellow), 0 0 25px var(--neon-yellow);
            transition: all 0.3s ease;
        }
        
        .neon-glow-purple:hover {
            box-shadow: 0 0 15px var(--neon-purple), 0 0 25px var(--neon-purple);
            transition: all 0.3s ease;
        }
        
        .neon-glow-orange:hover {
            box-shadow: 0 0 15px var(--neon-orange), 0 0 25px var(--neon-orange);
            transition: all 0.3s ease;
        }
        
        .neon-glow-red:hover {
            box-shadow: 0 0 15px var(--neon-red), 0 0 25px var(--neon-red);
            transition: all 0.3s ease;
        }
        
        .neon-glow-cyan:hover {
            box-shadow: 0 0 15px var(--neon-cyan), 0 0 25px var(--neon-cyan);
            transition: all 0.3s ease;
        }
        
        .category-btn {
            transition: all 0.3s ease;
            transform: scale(1);
        }
        
        .category-btn:hover {
            transform: scale(1.05);
        }
        
        .payment-item {
            border-left: 4px solid;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .history-item {
            border-left: 4px solid;
            animation: slideIn 0.5s ease-in;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 5px var(--neon-blue); }
            50% { box-shadow: 0 0 20px var(--neon-blue), 0 0 30px var(--neon-blue); }
            100% { box-shadow: 0 0 5px var(--neon-blue); }
        }
        
        .amount-input {
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            text-shadow: 0 0 5px white;
        }
        
        .amount-input:focus {
            outline: none;
            border-color: var(--neon-cyan);
            box-shadow: 0 0 10px var(--neon-cyan);
        }
        
        .total-display {
            background: linear-gradient(90deg, rgba(0, 243, 255, 0.2), rgba(189, 0, 255, 0.2));
            border: 2px solid var(--neon-purple);
            box-shadow: 0 0 15px var(--neon-purple), inset 0 0 10px var(--neon-blue);
        }
        
        .subcategory-item {
            transition: all 0.3s ease;
        }
        
        .subcategory-item:hover {
            transform: translateY(-3px);
        }
        
        .rupee-symbol {
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- Header -->
    <header class="p-4 neon-border-blue bg-black bg-opacity-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-3xl neon-text-blue font-bold">
                <i class="fas fa-wallet mr-2"></i>NeonExpense
            </h1>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <p class="neon-text-green text-sm">Welcome, User</p>
                    <p class="text-xs neon-text-cyan" id="currentDate"></p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4 mt-6">
        <!-- Payment Button -->
        <div class="text-center mb-8">
            <button id="openPaymentBtn" class="bg-black text-white py-4 px-8 rounded-lg text-xl font-bold neon-border-pink neon-glow-pink pulse">
                <i class="fas fa-money-bill-wave mr-2"></i>Make Payment
            </button>
        </div>

        <!-- Payment Modal -->
        <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
            <div class="neon-border-blue bg-gray-900 rounded-lg w-11/12 md:w-3/4 lg:w-2/3 xl:w-1/2 max-h-screen overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl neon-text-blue font-bold">What do you want to pay for?</h2>
                        <button id="closeModalBtn" class="text-white text-2xl">&times;</button>
                    </div>
                    
                    <!-- Categories -->
                    <div class="mb-6">
                        <h3 class="text-xl neon-text-green mb-3">Categories</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3" id="categoriesContainer">
                            <!-- Categories will be populated by JS -->
                        </div>
                    </div>
                    
                    <!-- Subcategories -->
                    <div class="mb-6 hidden" id="subcategoriesSection">
                        <h3 class="text-xl neon-text-yellow mb-3" id="subcategoriesTitle">Subcategories</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="subcategoriesContainer">
                            <!-- Subcategories will be populated by JS -->
                        </div>
                    </div>
                    
                    <!-- Manual Item Input -->
                    <div class="mb-6 hidden" id="manualItemSection">
                        <h3 class="text-xl neon-text-purple mb-3">Add Custom Item</h3>
                        <div class="flex flex-col md:flex-row gap-3">
                            <input type="text" id="customItemInput" placeholder="Enter item name" class="flex-grow bg-gray-800 text-white p-2 rounded border border-neon-purple focus:outline-none amount-input">
                            <input type="number" id="customItemAmount" placeholder="Amount in ₹" min="0" step="1" class="w-28 bg-gray-800 text-white p-2 rounded border border-neon-purple focus:outline-none amount-input">
                            <button id="addCustomItemBtn" class="bg-purple-900 text-white p-2 rounded border border-neon-purple neon-glow-purple">
                                <i class="fas fa-plus"></i> Add
                            </button>
                        </div>
                    </div>
                    
                    <!-- Payment List -->
                    <div class="mb-6">
                        <h3 class="text-xl neon-text-orange mb-3">Payment List</h3>
                        <div class="bg-gray-800 rounded p-4 min-h-32 max-h-64 overflow-y-auto" id="paymentListContainer">
                            <p class="text-gray-500 text-center py-10">Your selected items will appear here</p>
                        </div>
                    </div>
                    
                    <!-- Total Amount -->
                    <div class="mb-6 flex justify-between items-center p-4 total-display rounded-lg">
                        <span class="text-xl neon-text-cyan font-bold">Total Amount:</span>
                        <span class="text-2xl neon-text-yellow font-bold" id="totalAmount">₹0.00</span>
                    </div>
                    
                    <!-- Actions -->
                    <div class="flex justify-end space-x-3">
                        <button id="cancelPaymentBtn" class="bg-gray-700 text-white py-2 px-6 rounded neon-border-blue neon-glow-blue">Cancel</button>
                        <button id="confirmPaymentBtn" class="bg-blue-900 text-white py-2 px-6 rounded neon-border-blue neon-glow-blue">Pay Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment Simulation -->
        <div id="paymentSimulation" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
            <div class="neon-border-green bg-gray-900 rounded-lg w-11/12 md:w-1/2 lg:w-1/3 p-8 text-center">
                <div class="mb-6">
                    <i class="fas fa-check-circle text-6xl neon-text-green mb-4"></i>
                    <h2 class="text-2xl neon-text-green font-bold mb-2">Payment Successful!</h2>
                    <p class="text-white">Your payment has been processed successfully.</p>
                    <p class="neon-text-yellow mt-2">Total: <span id="paymentTotal"></span></p>
                </div>
                <button id="closeSimulationBtn" class="bg-green-900 text-white py-2 px-6 rounded neon-border-green neon-glow-green">OK</button>
            </div>
        </div>

        <!-- History Section -->
        <section class="mt-10">
            <h2 class="text-2xl neon-text-pink font-bold mb-6 flex items-center">
                <i class="fas fa-history mr-2"></i>Transaction History
            </h2>
            
            <div class="mb-4 flex flex-wrap gap-4">
                <input type="date" id="historyDateFilter" class="bg-gray-800 text-white p-2 rounded border border-neon-blue amount-input">
                <button id="filterHistoryBtn" class="bg-blue-900 text-white py-2 px-4 rounded neon-border-blue neon-glow-blue">Filter</button>
                <button id="clearHistoryFilterBtn" class="bg-gray-700 text-white py-2 px-4 rounded neon-border-blue neon-glow-blue">Clear Filter</button>
            </div>
            
            <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4 neon-border-blue">
                <div id="historyContainer" class="space-y-4 max-h-96 overflow-y-auto p-2">
                    <!-- History items will be populated by JS -->
                    <p class="text-gray-500 text-center py-10">Your transaction history will appear here</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="p-4 mt-8 neon-border-pink bg-black bg-opacity-50">
        <div class="container mx-auto text-center">
            <p class="neon-text-blue">NeonExpense &copy; 2023 - Tech-Savvy Expense Tracking</p>
        </div>
    </footer>

    <script>
        // Categories and subcategories data
        const categories = {
            grocery: {
                name: "Grocery",
                color: "blue",
                subcategories: [
                    "Fruits & Vegetables", "Dairy & Eggs", "Meat & Seafood", 
                    "Bakery", "Frozen Foods", "Beverages", "Snacks", 
                    "Canned Goods", "Pasta & Rice", "Cooking Oil", 
                    "Spices & Seasonings", "Cleaning Supplies", "Personal Care",
                    "Pet Supplies", "Baby Products", "Alcohol", "Organic Foods",
                    "International Foods", "Condiments", "Baking Supplies"
                ]
            },
            shopping: {
                name: "Shopping",
                color: "pink",
                subcategories: [
                    "Clothing", "Shoes", "Accessories", "Electronics", 
                    "Home Decor", "Furniture", "Kitchenware", "Books", 
                    "Sports Equipment", "Toys & Games", "Jewelry", 
                    "Beauty Products", "Tools & Hardware", "Gardening", 
                    "Stationery", "Craft Supplies", "Party Supplies", 
                    "Phone Accessories", "Watches", "Luggage"
                ]
            },
            food: {
                name: "Food",
                color: "green",
                subcategories: [
                    "Restaurant", "Fast Food", "Cafe", "Delivery", 
                    "Takeaway", "Food Truck", "Buffet", "Fine Dining", 
                    "Street Food", "Bakeries", "Ice Cream", "Desserts", 
                    "Bar", "Pub", "Coffee Shop", "Juice Bar", 
                    "Food Court", "Catering", "Food Delivery App", "Food Subscription"
                ]
            },
            medical: {
                name: "Medical",
                color: "purple",
                subcategories: [
                    "Doctor Visit", "Dentist", "Optometrist", "Prescription Medication", 
                    "Over-the-Counter Drugs", "Health Supplements", "Hospital Bills", 
                    "Medical Tests", "Health Insurance", "Therapy", "Physiotherapy", 
                    "Medical Equipment", "First Aid", "Specialist Consultation", 
                    "Emergency Room", "Alternative Medicine", "Mental Health", 
                    "Veterinary", "Medical Procedures", "Health Checkup"
                ]
            },
            recharge: {
                name: "Recharge",
                color: "yellow",
                subcategories: [
                    "Mobile Recharge", "Internet Bill", "DTH Recharge", 
                    "Electricity Bill", "Water Bill", "Gas Bill", 
                    "Broadband Bill", "Cable TV", "Landline", 
                    "OTT Subscription", "Gaming Credits", "E-Wallet", 
                    "Credit Card Bill", "Loan Payment", "Insurance Premium", 
                    "Municipal Taxes", "Maintenance Fees", "Club Membership", 
                    "Charity Donation", "Online Course"
                ]
            },
            education: {
                name: "Education",
                color: "orange",
                subcategories: [
                    "Tuition Fees", "Books", "School Supplies", "Uniform", 
                    "Online Courses", "Workshops", "Textbooks", "E-Learning", 
                    "Student Loan", "Exam Fees", "Library Fees", "Research Materials", 
                    "Educational Toys", "Software License", "School Donation", 
                    "Field Trips", "Art Supplies", "Music Lessons", "Sports Fees", 
                    "University Application"
                ]
            },
            health: {
                name: "Health",
                color: "cyan",
                subcategories: [
                    "Gym Membership", "Yoga Class", "Personal Trainer", "Sports Club", 
                    "Fitness Equipment", "Supplements", "Health Food", "Dietitian", 
                    "Massage", "Spa", "Sauna", "Wellness Retreat", 
                    "Meditation App", "Fitness App", "Sportswear", "Running Shoes", 
                    "Fitness Trackers", "Health Magazine", "Weight Management", "Smoking Cessation"
                ]
            },
            entertainment: {
                name: "Entertainment",
                color: "red",
                subcategories: [
                    "Movie Tickets", "Concert", "Theater", "Amusement Park", 
                    "Streaming Service", "Video Games", "Music Subscription", 
                    "Magazines", "Hobbies", "Party", "Nightclub", "Bowling", 
                    "Escape Room", "Karaoke", "Sports Event", "Museum", 
                    "Art Exhibition", "Comedy Show", "Festival", "Circus"
                ]
            },
            transport: {
                name: "Transport",
                color: "blue",
                subcategories: [
                    "Fuel", "Public Transport", "Taxi", "Ride Share", 
                    "Air Travel", "Train", "Bus", "Car Rental", 
                    "Car Maintenance", "Parking", "Tolls", "Bicycle", 
                    "Motorcycle", "Vehicle Insurance", "Vehicle Loan", 
                    "Tire Replacement", "Car Wash", "Auto Parts", "Vehicle Tax", "Ferry"
                ]
            },
            others: {
                name: "Others",
                color: "purple",
                subcategories: [
                    "Gifts", "Donations", "Tips", "Legal Fees", 
                    "Accounting", "Bank Fees", "Postage", "Printing", 
                    "Travel", "Accommodation", "Home Repair", "Gardening", 
                    "Pest Control", "Security", "Child Care", "Elder Care", 
                    "Storage", "Shipping", "Customs Duty", "Other"
                ]
            }
        };

        // Current state
        let currentCategory = null;
        let paymentItems = [];
        let transactionHistory = JSON.parse(localStorage.getItem('transactionHistory')) || [];

        // DOM Elements
        const openPaymentBtn = document.getElementById('openPaymentBtn');
        const paymentModal = document.getElementById('paymentModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const categoriesContainer = document.getElementById('categoriesContainer');
        const subcategoriesSection = document.getElementById('subcategoriesSection');
        const subcategoriesTitle = document.getElementById('subcategoriesTitle');
        const subcategoriesContainer = document.getElementById('subcategoriesContainer');
        const manualItemSection = document.getElementById('manualItemSection');
        const customItemInput = document.getElementById('customItemInput');
        const customItemAmount = document.getElementById('customItemAmount');
        const addCustomItemBtn = document.getElementById('addCustomItemBtn');
        const paymentListContainer = document.getElementById('paymentListContainer');
        const cancelPaymentBtn = document.getElementById('cancelPaymentBtn');
        const confirmPaymentBtn = document.getElementById('confirmPaymentBtn');
        const paymentSimulation = document.getElementById('paymentSimulation');
        const closeSimulationBtn = document.getElementById('closeSimulationBtn');
        const historyContainer = document.getElementById('historyContainer');
        const historyDateFilter = document.getElementById('historyDateFilter');
        const filterHistoryBtn = document.getElementById('filterHistoryBtn');
        const clearHistoryFilterBtn = document.getElementById('clearHistoryFilterBtn');
        const totalAmountElement = document.getElementById('totalAmount');
        const paymentTotalElement = document.getElementById('paymentTotal');
        const currentDateElement = document.getElementById('currentDate');

        // Initialize the app
        function initApp() {
            // Set current date
            const now = new Date();
            currentDateElement.textContent = now.toLocaleDateString('en-US', { 
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
            });
            
            // Set today as default filter
            historyDateFilter.valueAsDate = now;
            
            // Render categories
            renderCategories();
            
            // Load transaction history
            loadTransactionHistory();
            
            // Event listeners
            openPaymentBtn.addEventListener('click', () => {
                paymentModal.classList.remove('hidden');
            });
            
            closeModalBtn.addEventListener('click', closePaymentModal);
            cancelPaymentBtn.addEventListener('click', closePaymentModal);
            
            confirmPaymentBtn.addEventListener('click', () => {
                if (paymentItems.length === 0) {
                    alert('Please add at least one item to pay for');
                    return;
                }
                
                processPayment();
            });
            
            closeSimulationBtn.addEventListener('click', () => {
                paymentSimulation.classList.add('hidden');
                closePaymentModal();
                loadTransactionHistory();
            });
            
            addCustomItemBtn.addEventListener('click', addCustomItem);
            
            customItemInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addCustomItem();
                }
            });
            
            filterHistoryBtn.addEventListener('click', loadTransactionHistory);
            clearHistoryFilterBtn.addEventListener('click', () => {
                historyDateFilter.value = '';
                loadTransactionHistory();
            });
        }

        // Render categories
        function renderCategories() {
            categoriesContainer.innerHTML = '';
            
            for (const [key, category] of Object.entries(categories)) {
                const btn = document.createElement('button');
                btn.className = `category-btn p-3 rounded text-center neon-border-${category.color} neon-bg-${category.color} neon-glow-${category.color}`;
                btn.innerHTML = `<i class="fas fa-${getCategoryIcon(key)} mb-1"></i><br>${category.name}`;
                
                btn.addEventListener('click', () => {
                    currentCategory = key;
                    subcategoriesTitle.textContent = `${category.name} Subcategories`;
                    renderSubcategories();
                });
                
                categoriesContainer.appendChild(btn);
            }
        }

        // Get icon for category
        function getCategoryIcon(categoryKey) {
            const icons = {
                grocery: 'shopping-basket',
                shopping: 'shopping-bag',
                food: 'utensils',
                medical: 'first-aid',
                recharge: 'mobile-alt',
                education: 'graduation-cap',
                health: 'heartbeat',
                entertainment: 'film',
                transport: 'car',
                others: 'ellipsis-h'
            };
            
            return icons[categoryKey] || 'circle';
        }

        // Render subcategories
        function renderSubcategories() {
            subcategoriesSection.classList.remove('hidden');
            manualItemSection.classList.remove('hidden');
            
            const category = categories[currentCategory];
            subcategoriesContainer.innerHTML = '';
            
            category.subcategories.forEach(subcat => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'subcategory-item flex items-center mb-3 p-2 rounded neon-border-blue neon-bg-blue';
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'flex-grow text-sm';
                nameSpan.textContent = subcat;
                
                const inputGroup = document.createElement('div');
                inputGroup.className = 'flex items-center';
                
                const amountInput = document.createElement('input');
                amountInput.type = 'number';
                amountInput.min = '0';
                amountInput.step = '1';
                amountInput.placeholder = '₹ Amount';
                amountInput.className = 'amount-input w-24 p-1 rounded-l border border-r-0 border-neon-blue focus:outline-none';
                
                const addBtn = document.createElement('button');
                addBtn.className = `p-1 rounded-r neon-border-${category.color} neon-bg-${category.color} neon-glow-${category.color}`;
                addBtn.innerHTML = '<i class="fas fa-plus"></i>';
                
                addBtn.addEventListener('click', () => {
                    const amount = parseFloat(amountInput.value);
                    if (isNaN(amount) || amount <= 0) {
                        alert('Please enter a valid amount');
                        return;
                    }
                    addPaymentItem(subcat, currentCategory, amount);
                    amountInput.value = '';
                });
                
                inputGroup.appendChild(amountInput);
                inputGroup.appendChild(addBtn);
                
                itemDiv.appendChild(nameSpan);
                itemDiv.appendChild(inputGroup);
                
                subcategoriesContainer.appendChild(itemDiv);
            });
        }

        // Add payment item
        function addPaymentItem(name, category, amount) {
            const id = Date.now() + Math.random().toString(36).substr(2, 5);
            paymentItems.push({ id, name, category, amount });
            renderPaymentList();
            updateTotalAmount();
        }

        // Add custom item
        function addCustomItem() {
            const itemName = customItemInput.value.trim();
            const amount = parseFloat(customItemAmount.value);
            
            if (!itemName) {
                alert('Please enter an item name');
                return;
            }
            
            if (isNaN(amount) || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (!currentCategory) {
                alert('Please select a category first');
                return;
            }
            
            addPaymentItem(itemName, currentCategory, amount);
            customItemInput.value = '';
            customItemAmount.value = '';
        }

        // Render payment list
        function renderPaymentList() {
            paymentListContainer.innerHTML = '';
            
            if (paymentItems.length === 0) {
                paymentListContainer.innerHTML = '<p class="text-gray-500 text-center py-10">Your selected items will appear here</p>';
                return;
            }
            
            paymentItems.forEach(item => {
                const category = categories[item.category];
                const itemEl = document.createElement('div');
                itemEl.className = `payment-item p-3 mb-2 rounded bg-gray-700 bg-opacity-50 border-l-${category.color} flex justify-between items-center`;
                itemEl.innerHTML = `
                    <div>
                        <span class="neon-text-${category.color}">${item.name}</span>
                        <span class="text-xs text-gray-400 block">${category.name}</span>
                    </div>
                    <div class="flex items-center">
                        <span class="neon-text-yellow mr-3">₹${item.amount.toFixed(2)}</span>
                        <button class="delete-item text-red-500 hover:text-red-300" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                paymentListContainer.appendChild(itemEl);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-item').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = e.currentTarget.getAttribute('data-id');
                    paymentItems = paymentItems.filter(item => item.id !== id);
                    renderPaymentList();
                    updateTotalAmount();
                });
            });
        }

        // Update total amount
        function updateTotalAmount() {
            const total = paymentItems.reduce((sum, item) => sum + item.amount, 0);
            totalAmountElement.textContent = `₹${total.toFixed(2)}`;
        }

        // Close payment modal
        function closePaymentModal() {
            paymentModal.classList.add('hidden');
            subcategoriesSection.classList.add('hidden');
            manualItemSection.classList.add('hidden');
            paymentItems = [];
            currentCategory = null;
            renderPaymentList();
            updateTotalAmount();
        }

        // Process payment
        function processPayment() {
            const total = paymentItems.reduce((sum, item) => sum + item.amount, 0);
            
            // Create transaction record
            const transaction = {
                id: Date.now(),
                items: [...paymentItems],
                total,
                date: new Date()
            };
            
            // Add to history
            transactionHistory.unshift(transaction);
            
            // Save to localStorage
            localStorage.setItem('transactionHistory', JSON.stringify(transactionHistory));
            
            // Show success simulation
            paymentTotalElement.textContent = `₹${total.toFixed(2)}`;
            paymentModal.classList.add('hidden');
            paymentSimulation.classList.remove('hidden');
            
            // Update history
            loadTransactionHistory();
        }

        // Load transaction history
        function loadTransactionHistory() {
            historyContainer.innerHTML = '';
            
            let filteredHistory = transactionHistory;
            
            // Apply date filter if set
            if (historyDateFilter.value) {
                const selectedDate = new Date(historyDateFilter.value);
                filteredHistory = transactionHistory.filter(transaction => {
                    const transactionDate = new Date(transaction.date);
                    return transactionDate.toDateString() === selectedDate.toDateString();
                });
            }
            
            if (filteredHistory.length === 0) {
                historyContainer.innerHTML = '<p class="text-gray-500 text-center py-10">No transactions found</p>';
                return;
            }
            
            filteredHistory.forEach(transaction => {
                const date = new Date(transaction.date);
                const formattedDate = date.toLocaleDateString('en-IN') + ' ' + date.toLocaleTimeString('en-IN');
                
                const transactionEl = document.createElement('div');
                transactionEl.className = 'history-item p-4 rounded bg-gray-700 bg-opacity-50';
                
                let itemsHtml = '';
                transaction.items.forEach(item => {
                    const category = categories[item.category];
                    itemsHtml += `
                        <div class="inline-flex items-center mr-2 mb-2 px-2 py-1 rounded neon-bg-${category.color} neon-border-${category.color}">
                            <span class="text-xs">${item.name}</span>
                            <span class="text-xs neon-text-yellow ml-1">₹${item.amount.toFixed(2)}</span>
                        </div>
                    `;
                });
                
                transactionEl.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex-1">
                            <div class="neon-text-blue text-sm">${formattedDate}</div>
                            <div class="mt-2 flex flex-wrap">${itemsHtml}</div>
                        </div>
                        <div class="text-right">
                            <div class="neon-text-green text-lg font-bold">₹${transaction.total.toFixed(2)}</div>
                            <div class="text-xs text-gray-400">${transaction.items.length} items</div>
                        </div>
                    </div>
                `;
                
                historyContainer.appendChild(transactionEl);
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
